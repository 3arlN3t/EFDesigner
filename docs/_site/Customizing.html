<!DOCTYPE html>
<html lang="en-US">
<head>
   <meta charset="UTF-8">
   <!-- Global site tag (gtag.js) - Google Analytics -->
   <script async src="https://www.googletagmanager.com/gtag/js?id=UA-116198145-1"></script>
   <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() { dataLayer.push(arguments); }
      gtag('js', new Date());
      gtag('config', 'UA-116198145-1');
   </script>

   <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Customizing Code Generation | Entity Framework Visual Designer</title>
<meta name="generator" content="Jekyll v3.6.2" />
<meta property="og:title" content="Customizing Code Generation" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Entity Framework visual design surface and code-first code generation for EF6, EFCore and beyond" />
<meta property="og:description" content="Entity Framework visual design surface and code-first code generation for EF6, EFCore and beyond" />
<link rel="canonical" href="http://localhost:4000/Customizing.html" />
<meta property="og:url" content="http://localhost:4000/Customizing.html" />
<meta property="og:site_name" content="Entity Framework Visual Designer" />
<script type="application/ld+json">
{"description":"Entity Framework visual design surface and code-first code generation for EF6, EFCore and beyond","@type":"WebPage","url":"http://localhost:4000/Customizing.html","headline":"Customizing Code Generation","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

   <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="theme-color" content="#157878">
   <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
   <link rel="stylesheet" href="/assets/css/style.css?v=0d8ebc97586a633e0378b9c27f7cbbca5f0deb28">
   <style>
      .sidebar {
         float: right;
         width: 256px;
         min-height: 35em;
         border: 1px solid darkgreen;
         margin-left: 3em;
         margin-top: 2em;
         padding: 1em;
         font-size: 14px;
      }

         .sidebar a, .sidebar a:visited, .sidebar a:hover {
            display: block;
            color: #159957;
         }

            .sidebar a + a {
               margin-top: .5em;
            }

         .sidebar ul {
            margin-top: 0;
            margin-bottom: .5em;
         }

      .content-wrapper {
         max-width: 80em;
         margin: 0 auto;
      }

      .site-footer {
         font-size: .7em;
      }

      .site-footer-owner {
         font-weight: normal;
      }

      .main-content {
         margin: 0;
      }

         .main-content a,
         .main-content a:visited {
            color: firebrick;
         }

            .main-content a:hover {
               color: firebrick;
               /*text-decoration: none;*/
            }

         .main-content table {
            font-size: .95rem;
         }

            .main-content table th, .main-content table td {
               border: 1px solid darkgray;
            }

            .main-content table tr th:first-child {
               width: 20%;
            }

         .main-content h2 {
            border-top: 2px double #159957;
            margin-top: 3rem;
         }

      @media screen and (max-width: 42em) {
         .sidebar {
            display: none;
         }
      }
   </style>
</head>
<body>
   <section class="page-header">
      <h1 class="project-name">Entity Framework Visual Designer</h1>
      <h2 class="project-tagline">Entity Framework visual design surface and code-first code generation for EF6, EFCore and beyond</h2>
      
      <a href="http://github.com/msawczyn/EFDesigner" class="btn">View on GitHub</a>
      
      
      <a href="http://github.com/msawczyn/EFDesigner/zipball/gh-pages" class="btn">Download .zip</a>
      <a href="http://github.com/msawczyn/EFDesigner/tarball/gh-pages" class="btn">Download .tar.gz</a>
      
   </section>

   <div class="content-wrapper">
      <div class="sidebar">
         <a href="index.html">Home</a>
         <a href="Getting-Started.html">Getting Started</a>
         <a href="Using-the-designer.html">Using the Designer</a>
         <ul>
            <li><a href="Using-the-designer.html#design-surface-properties">Design Surface Properties</a></li>
            <li><a href="Using-the-designer.html#context-menu">Context menu</a></li>
         </ul>
         <a href="Entities.html">Persistent Entities</a>
         <ul>
            <li><a href="Entities.html#adding-an-entity">Adding an entity</a></li>
            <li><a href="Entities.html#removing-an-entity">Removing an entity</a></li>
            <li><a href="Entities.html#context-menu">Context menu</a></li>
         </ul>
         <a href="Properties.html">Properties</a>
         <ul>
            <li><a href="Properties.html#adding-a-property">Adding a property</a></li>
            <li><a href="Properties.html#removing-a-property">Removing a property</a></li>
            <li><a href="Properties.html#context-menu">Context menu</a></li>
            <li><a href="Properties.html#adding-properties-via-code-custom-property-syntax">Adding properties via code</a></li>
         </ul>
         <a href="Associations.html">Associations</a>
         <ul>
            <li><a href="Associations.html#cardinalities">Cardinalities</a></li>
            <li><a href="Associations.html#unidirectional-associations">Unidirectional Associations</a></li>
            <li><a href="Associations.html#bidirectional-associations">Bidirectional Associations</a></li>
         </ul>
         <a href="Inheritance.html">Inheritance</a>
         <a href="Enumerations.html">Enumerations</a>
         <ul>
            <li><a href="Enumerations.html#adding-a-value">Adding a value</a></li>
            <li><a href="Enumerations.html#removing-a-value">Removing a value</a></li>
            <li><a href="Enumerations.html#context-menu">Context menu</a></li>
         </ul>
         <a href="Comments.html">Comments</a>
         <ul>
            <li><a href="Comments.html#comment-links">Comment Links</a></li>
         </ul>
         <a href="Templates.html">Generating Code</a>
         <ul>
            <li><a href="Templates.html#whats-generated">What's Generated</a></li>
         </ul>
         <a href="Customizing.html">Customizing Code Generation</a>
         <ul>
            <li><a href="Customizing.html#partial-classes">Partial Classes</a></li>
            <li><a href="Customizing.html#replacing-the-t4-templates">Replacing the T4 Templates</a></li>
         </ul>
         <a href="Development.html">Contributing</a>
         <a href="Licensing.html">License</a>

      </div>
      <section class="main-content">
         <h1 id="customizing-code-generation">Customizing Code Generation</h1>

<p>Easy code customization was a design goal with this tool. There are two levels, 
and you can choose which one is best depending on your needs.</p>

<h2 id="partial-classes">Partial Classes</h2>

<p>Easiest is to simply extend the custom code by implementing partial classes. Use these
to add any methods to the generated classes you need; they’ll be untouched if the model is 
later regenerated.</p>

<p>The generated code also creates partial methods at locations that have historically shown themselves to be common
places for extension. Those are:</p>
<ul>
<li>Your DbContext-derived class (CustomInit, OnModelCreatingImpl, and OnModelCreatedImpl)</li>
<li>Each persistent entity (Init)</li>
</ul>

<p>Remember that partial methods, if not implemented, don’t generate IL and therefore don’t have
any performance overhead, so they’re an excellent means of optional behavior injection.</p>

<h2 id="replacing-the-t4-templates">Replacing the T4 Templates</h2>

<p>You can easily replace the T4 templates installed with the extension either globally or on a project-by-project basis.
The trick (thanks Microsoft!) is finding them.</p>

<p>When extensions are installed into Visual Studio, they’re copied to</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>C:\Users\[User Name]\AppData\Local\Microsoft\VisualStudio\15.0\Extensions
</code></pre></div></div>

<p>The “15.0” part may have some hexadecimal gibberish appended to it if you’ve installed more than one flavor of
Visual Studio 2017 (Community, Enterprise, etc.) since it needs to keep the various
settings separate. If you don’t know which one you need, check the shortcut you use to start
Visual Studio.</p>

<p>The fun begins when you get to the Extensions directory … each extension is installed in a 
unique folder with a random (pseudo-random?) name. The easiest thing to do is to hunt for <code>EFDesigner.ttinclude</code>
starting in the Extensions folder.</p>

<p>When you find it, you’ll see five .ttinclude files there:</p>
<table>
<thead>
<tr><th valign="top"><b>File</b></th><th valign="top"><b>Description</b></th></tr>
</thead>
<tbody>
<tr><td valign="top"><code style="background-color: transparent;">EFDesigner.ttinclude</code></td><td valign="top">Code useful to all flavors of Entity Framework. Also contains code to write the entities and enumerations.</td></tr>
<tr><td valign="top"><code style="background-color: transparent;">EF6Designer.ttinclude</code></td><td valign="top">Writes the EF6 DbContext, database initializer and migration configuration. Any code that only works with EF6 is defined here. </td></tr>
<tr><td valign="top"><code style="background-color: transparent;">EFCoreDesigner.ttinclude</code></td><td valign="top">Same as above, but for EF Core instead.</td></tr>
<tr><td valign="top"><code style="background-color: transparent;">MultipleOutputHelper.ttinclude</code></td><td valign="top">Code to create more than one output file, since T4 usually doesn't do that. You probably won't mess with this.</td></tr>
<tr><td valign="top"><code style="background-color: transparent;">VSIntegration.ttinclude</code></td><td valign="top">Code to talk to Visual Studio so we can add project items, etc. You probably won't mess with this either.</td></tr>
</tbody>
</table>

<p>Decide what you want to replace and copy the file into your project directory. Modify at will …
the templating engine will find your local copy before it looks anywhere else.</p>

<p>For code generation from the T4, the flow of events starts at the [Model Name].tt file in your
project. Its template directives tell it to include the five templates listed above and then,
based on the Entity Framework type specified, call one of two entry points.</p>

<p>You’ll notice that these aren’t your standard T4 templates, where the bulk of the file is text
to be outpout. Rather, they’re like scripting libraries. That’s on purpose – a design goal was
to allow the generation to be customizable but, at the same time, understandable to the average
programmer. A group of function calls is easier to read, IMHO, than your every-day T4 template,
so that’s what we have.</p>

<p>The templating engine works through the model, pulling together all the code in memory. It isn’t
until the call to <code class="highlighter-rouge">manager.Process(true)</code> at the end that the files are generated. So any customizations
to the process should come before that call.</p>

<h3 id="next-step">Next Step</h3>
<p><a href="Development">Contributing</a></p>

      </section>
      <footer class="site-footer">







         
         <!--<span class="site-footer-owner"><a href="http://github.com/msawczyn/EFDesigner">EFDesigner</a> is maintained by <a href="http://github.com/msawczyn">Michael Sawczyn</a>.</span>-->
         
         <!--<span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</span>-->
      </footer>
   </div>

</body>
</html>
